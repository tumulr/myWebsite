---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const blogPosts = await getCollection('blog');
// Sort posts by date (most recent first)
const sortedPosts = blogPosts.sort((a, b) => {
  return new Date(b.data.date).getTime() - new Date(a.data.date).getTime();
});
---

<Layout>
  <section class="blog-header">
    <h1>My Blog</h1>
    <p>Welcome to my blog! Here I share my thoughts and experiences.</p>
  </section>

  <section class="blog-posts">
    {sortedPosts.map(post => (
      <article class="blog-post">
        <h2>{post.data.title}</h2>
        <p class="post-date">{post.data.date}</p>
        <p class="post-excerpt">
          {post.body.split('\n\n')[0]}
        </p>
        <a href={`/blog/${post.slug}`} class="read-more">Read more</a>
      </article>
    ))}
  </section>
</Layout>

<style>
  .blog-header {
    text-align: center;
    padding: 3rem 1rem;
    background-color: #f9f9f9;
    border-radius: 8px;
    margin-bottom: 2rem;
  }

  .blog-header h1 {
    font-size: 2.5rem;
    margin-bottom: 1rem;
  }

  .blog-posts {
    display: grid;
    gap: 2rem;
  }

  .blog-post {
    background-color: white;
    padding: 2rem;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
  }

  .blog-post h2 {
    margin-top: 0;
    color: #333;
  }

  .post-date {
    color: #666;
    font-size: 0.9rem;
    margin-bottom: 1rem;
  }

  .read-more {
    display: inline-block;
    margin-top: 1rem;
    color: #0066cc;
    text-decoration: none;
    font-weight: 500;
  }

  .read-more:hover {
    text-decoration: underline;
  }
</style>